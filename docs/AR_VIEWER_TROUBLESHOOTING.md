# AR Viewer: –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–µ

## –í–∞–∂–Ω–æ: –≤–µ–±-AR –æ—Ç–∫–ª—é—á—ë–Ω

**–ü—Ä–æ—Å–º–æ—Ç—Ä AR –≤ –±—Ä–∞—É–∑–µ—Ä–µ (MindAR) –æ—Ç–∫–ª—é—á—ë–Ω.** –ü—Ä–æ—Å–º–æ—Ç—Ä AR –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ **¬´AR Viewer¬ª** (Android, ARCore).

- –°—Å—ã–ª–∫–∞ `https://your-domain.com/view/{unique_id}` –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç **–ª–µ–Ω–¥–∏–Ω–≥** —Å –∫–Ω–æ–ø–∫–∞–º–∏ ¬´–û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏¬ª –∏ ¬´–°–∫–∞—á–∞—Ç—å –≤ Google Play¬ª.
- –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –ø–æ–ª—É—á–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ API: `GET /api/viewer/ar/{unique_id}/manifest` (marker_image_url = —Ñ–æ—Ç–æ, video, expires_at).
- –ú–∞—Ä–∫–µ—Ä –¥–ª—è ARCore ‚Äî —ç—Ç–æ **—Ñ–æ—Ç–æ** (—Ç–æ –∂–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ, —á—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –¥–ª—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞); —Ñ–∞–π–ª—ã `.mind` –±–æ–ª—å—à–µ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

–ù–∏–∂–µ ‚Äî —Å–ø—Ä–∞–≤–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –ø–æ –ø—Ä–µ–∂–Ω–µ–º—É –≤–µ–±-–≤—å—é–≤–µ—Ä—É (MindAR) –∏ —Ç–∏–ø–∏—á–Ω—ã–º –ø—Ä–æ–±–ª–µ–º–∞–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤; –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–º. –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.

---

## –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ AR Viewer (ARCore)

–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è –∫ —Å–µ—Ä–≤–µ—Ä—É –∏ –º–∞—Ä–∫–µ—Ä—É –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

### –ú–∞—Ä–∫–µ—Ä (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞)

- **–§–æ—Ä–º–∞—Ç:** JPEG –∏–ª–∏ PNG (—Ç–æ, —á—Ç–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ –≤ –∞–¥–º–∏–Ω–∫–µ –∫–∞–∫ —Ñ–æ—Ç–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞). ARCore –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —ç—Ç–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–∞–∫ —Ü–µ–ª—å –¥–ª—è —Ç—Ä–µ–∫–∏–Ω–≥–∞.
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:** –ß—ë—Ç–∫–æ–µ, —Ö–æ—Ä–æ—à–æ –æ—Å–≤–µ—â—ë–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å –∫–æ–Ω—Ç—Ä–∞—Å—Ç–Ω—ã–º–∏ –¥–µ—Ç–∞–ª—è–º–∏ –¥–∞—ë—Ç –ª—É—á—à—É—é —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å —Ç—Ä–µ–∫–∏–Ω–≥–∞. –ò–∑–±–µ–≥–∞–π—Ç–µ —Ä–∞–∑–º—ã—Ç—ã—Ö –∏–ª–∏ –æ–¥–Ω–æ—Ç–æ–Ω–Ω—ã—Ö –∫–∞—Ä—Ç–∏–Ω–æ–∫.
- **–†–∞–∑–¥–∞—á–∞:** URL –º–∞—Ä–∫–µ—Ä–∞ –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç—Å—è –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ –≤ –ø–æ–ª—è—Ö `marker_image_url` –∏ `photo_url`. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ `GET /api/ar-content/image/{unique_id}` (—Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ —Ñ–∞–π–ª). –î–ª—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∑–∞–≥–æ–ª–æ–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞ (–≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –æ—Ç–¥–∞–≤–∞—Ç—å –º–∞—Ä–∫–µ—Ä –ø–æ HTTPS —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º `Cache-Control`).

### HTTPS

- –ü—Ä–æ—Å–º–æ—Ç—Ä AR –∏ –¥–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ —Ä–∞–±–æ—Ç–∞—é—Ç —Ç–æ–ª—å–∫–æ –ø–æ **HTTPS**. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `PUBLIC_URL` –≤ –ø—Ä–æ–¥–∞–∫—à–µ–Ω–µ —É–∫–∞–∑—ã–≤–∞–µ—Ç –Ω–∞ `https://...`.
- –í—Å–µ URL –≤ –º–∞–Ω–∏—Ñ–µ—Å—Ç–µ (marker_image_url, video_url –∏ —Ç.–¥.) —Å—Ç—Ä–æ—è—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ `PUBLIC_URL`, –ø–æ—ç—Ç–æ–º—É –ø—Ä–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–µ –º–∞—Ä–∫–µ—Ä –∏ –≤–∏–¥–µ–æ –æ—Ç–¥–∞—é—Ç—Å—è –ø–æ HTTPS.

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –±–µ–∑ –∏–Ω–∫—Ä–µ–º–µ–Ω—Ç–∞ –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–≤

- **Endpoint:** `GET /api/viewer/ar/{unique_id}/check`
- **–û—Ç–≤–µ—Ç:** `{ "content_available": true }` –∏–ª–∏ `{ "content_available": false, "reason": "‚Ä¶" }`. –í–æ–∑–º–æ–∂–Ω—ã–µ `reason`: `invalid_unique_id`, `not_found`, `subscription_expired`, `content_not_active`, `marker_image_not_available`, `no_playable_video`.
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —ç—Ç–æ—Ç endpoint, —á—Ç–æ–±—ã –ø–æ–∫–∞–∑–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é —Å–æ–æ–±—â–µ–Ω–∏–µ –¥–æ –∑–∞–ø—Ä–æ—Å–∞ –ø–æ–ª–Ω–æ–≥–æ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä, ¬´–ö–æ–Ω—Ç–µ–Ω—Ç –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω¬ª –∏–ª–∏ ¬´–ü–æ–¥–ø–∏—Å–∫–∞ –∏—Å—Ç–µ–∫–ª–∞¬ª).

### –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞

- ARCore –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –Ω–µ –Ω–∞ –≤—Å–µ—Ö Android-—É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö. –°–ø–∏—Å–æ–∫ —Å–æ–≤–º–µ—Å—Ç–∏–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤: [ARCore supported devices](https://developers.google.com/ar/devices).
- –ù–∞ –Ω–µ–ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –º–æ–∂–µ—Ç –ø–æ–∫–∞–∑–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏–µ –æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –¥—Ä—É–≥–æ–≥–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞.

### Deep links: App Link –∏ custom scheme

- **–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞:** –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª–µ–Ω **App Link** –ø–æ HTTPS: `https://your-domain.com/view/{unique_id}`. –ï—Å–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω intent-filter —Å `autoVerify=true` –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –¥–æ—Å—Ç—É–ø–µ–Ω `/.well-known/assetlinks.json` —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ SHA-256 –æ—Ç–ø–µ—á–∞—Ç–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, Android –æ—Ç–∫—Ä–æ–µ—Ç —Å—Å—ã–ª–∫—É —Å—Ä–∞–∑—É –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –±–µ–∑ –¥–∏–∞–ª–æ–≥–∞ ¬´–û—Ç–∫—Ä—ã—Ç—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –∏–ª–∏ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏¬ª.
- **–ó–∞–ø–∞—Å–Ω–æ–π –≤–∞—Ä–∏–∞–Ω—Ç:** custom scheme `arv://view/{unique_id}`. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –∫–Ω–æ–ø–∫–æ–π ¬´–û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏¬ª –Ω–∞ –ª–µ–Ω–¥–∏–Ω–≥–µ; —Ä–∞–±–æ—Ç–∞–µ—Ç –∏ –±–µ–∑ –≤–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏–∏ App Links, –Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å –≤—ã–±–æ—Ä ¬´–û—Ç–∫—Ä—ã—Ç—å –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ / –≤ –±—Ä–∞—É–∑–µ—Ä–µ¬ª, –µ—Å–ª–∏ –ø–µ—Ä–µ—à—ë–ª –ø–æ HTTPS-—Å—Å—ã–ª–∫–µ.
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ:** –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `ANDROID_APP_PACKAGE` –∏ `ANDROID_APP_SHA256_FINGERPRINTS` (—Å–º. README). –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –æ—Ç–ø–µ—á–∞—Ç–∫–æ–≤ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å `https://your-domain.com/.well-known/assetlinks.json`.

### –°—Ç–∞—Ä—ã–µ QR-–∫–æ–¥—ã

- –¢–µ–∫—É—â–∏–π —Ñ–æ—Ä–º–∞—Ç —Å—Å—ã–ª–∫–∏ –≤ QR: `{PUBLIC_URL}/view/{unique_id}`.
- –ï—Å–ª–∏ –≤ —Å—Ç–∞—Ä—ã—Ö QR –±—ã–ª–∞ —Å—Å—ã–ª–∫–∞ –≤–∏–¥–∞ `‚Ä¶/ar/{unique_id}` (–±–µ–∑ `/view/`), —Å–µ—Ä–≤–µ—Ä –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/view/{unique_id}` (—Ä–µ–¥–∏—Ä–µ–∫—Ç 302). –ü–µ—Ä–µ–ø–µ—á–∞—Ç—ã–≤–∞—Ç—å QR –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ.
- –ï—Å–ª–∏ —Å—Ç–∞—Ä—ã–µ QR –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞—é—Ç—Å—è, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ: —Å–æ–≤–ø–∞–¥–∞–µ—Ç –ª–∏ —Ö–æ—Å—Ç –∏ –ø–æ—Ä—Ç –≤ QR —Å —Ç–µ–∫—É—â–∏–º `PUBLIC_URL` (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø–æ—Å–ª–µ —Å–º–µ–Ω—ã –¥–æ–º–µ–Ω–∞ –∏–ª–∏ –ø–æ—Ä—Ç–∞ —Å—Ç–∞—Ä—ã–µ QR –≤–µ–¥—É—Ç –Ω–∞ —Å—Ç–∞—Ä—ã–π –∞–¥—Ä–µ—Å).

### –õ–æ–≥ ¬´Invalid HTTP request received¬ª (uvicorn)

- –ü–æ—è–≤–ª–µ–Ω–∏–µ –≤ –ª–æ–≥–∞—Ö **WARNING: Invalid HTTP request received** –æ–±—ã—á–Ω–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –Ω–∞ –ø–æ—Ä—Ç –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (8000) –ø—Ä–∏—à—ë–ª –Ω–µ HTTP-–∑–∞–ø—Ä–æ—Å. –ß–∞—Å—Ç—ã–µ –ø—Ä–∏—á–∏–Ω—ã:
  - **HTTPS –Ω–∞ HTTP-–ø–æ—Ä—Ç:** –∫–ª–∏–µ–Ω—Ç –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç `https://...` –ø—Ä–∏ —Ç–æ–º, —á—Ç–æ uvicorn —Å–ª—É—à–∞–µ—Ç —Ç–æ–ª—å–∫–æ HTTP (–±–µ–∑ TLS). –ù—É–∂–Ω–æ –ª–∏–±–æ –ø–æ–¥–Ω—è—Ç—å HTTPS –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (–∏–ª–∏ –∑–∞ –ø—Ä–æ–∫—Å–∏ —Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ–º SSL), –ª–∏–±–æ –æ—Ç–∫—Ä—ã–≤–∞—Ç—å —Å—Å—ã–ª–∫–∏ –ø–æ `http://` –ø—Ä–∏ —Ç–µ—Å—Ç–∞—Ö.
  - –ü—Ä–æ–≤–µ—Ä–∫–∞ App Links —Å —Ç–µ–ª–µ—Ñ–æ–Ω–∞ –∏–ª–∏ —Å–∫–∞–Ω–µ—Ä, –æ—Ç–ø—Ä–∞–≤–ª—è—é—â–∏–π –∑–∞–ø—Ä–æ—Å —Å –Ω–µ–≤–µ—Ä–Ω—ã–º –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º/–ø–æ—Ä—Ç–æ–º.
- –ù–∞ —Ä–∞–±–æ—Ç—É —Ç–µ–∫—É—â–∏—Ö —Å—Å—ã–ª–æ–∫ –∏ –º–∞–Ω–∏—Ñ–µ—Å—Ç–∞ —ç—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –æ–±—ã—á–Ω–æ –Ω–µ –≤–ª–∏—è–µ—Ç.

---

## –ë—ã—Å—Ç—Ä–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ (–∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∞—è, –≤–µ–± MindAR)

| –°–∏–º–ø—Ç–æ–º | –ü—Ä–∏—á–∏–Ω–∞ | –†–µ—à–µ–Ω–∏–µ |
|---------|---------|---------|
| "–ö–∞–º–µ—Ä–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞" | –ù–µ—Ç –∫–∞–º–µ—Ä—ã –Ω–∞ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ | –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –≤–µ–±-–∫–∞–º–µ—Ä—É |
| "–î–æ—Å—Ç—É–ø –∫ –∫–∞–º–µ—Ä–µ –∑–∞–ø—Ä–µ—â—ë–Ω" | –ù–µ –¥–∞–Ω–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ | –ù–∞–∂–º–∏—Ç–µ "–†–∞–∑—Ä–µ—à–∏—Ç—å" –≤ –±—Ä–∞—É–∑–µ—Ä–µ |
| "WebGL –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω" | –û—Ç–∫–ª—é—á–µ–Ω–æ –∞–ø–ø–∞—Ä–∞—Ç–Ω–æ–µ —É—Å–∫–æ—Ä–µ–Ω–∏–µ | –í–∫–ª—é—á–∏—Ç–µ –≤ `chrome://settings` ‚Üí –°–∏—Å—Ç–µ–º–∞ |
| –¢–∞–π–º–∞—É—Ç 3 –º–∏–Ω | –ú–µ–¥–ª–µ–Ω–Ω—ã–π –º–æ–±–∏–ª—å–Ω—ã–π GPU | –û—Ç–∫—Ä–æ–π—Ç–µ –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ |
| "MINDAR: false" | –ü—Ä–æ–±–ª–µ–º–∞ –∑–∞–≥—Ä—É–∑–∫–∏ CDN | –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç |
| –ü—É—Å—Ç–∞—è –æ—à–∏–±–∫–∞ `{}` | MindAR –æ—Ç–∫–ª–æ–Ω–∏–ª –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è | –°–º. –ª–æ–≥–∏ debug panel |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```
AR Viewer
‚îú‚îÄ‚îÄ Three.js 0.147.0 (CDN) ‚Äî 3D —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥
‚îú‚îÄ‚îÄ MindAR 1.1.5 (CDN) ‚Äî Image tracking
‚îÇ   ‚îî‚îÄ‚îÄ TensorFlow.js ‚Äî WebGL backend (CPU –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è!)
‚îî‚îÄ‚îÄ .mind –º–∞—Ä–∫–µ—Ä—ã ‚Äî —Ñ–æ—Ä–º–∞—Ç MindAR
```

**–í–∞–∂–Ω–æ:** MindAR —Ç—Ä–µ–±—É–µ—Ç **WebGL backend**. CPU backend –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –∏–∑-–∑–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è WebGL-—Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã—Ö API (`texData`, `gpgpu`, `compileAndRun`).

---

## –≠—Ç–∞–ø—ã –∑–∞–≥—Ä—É–∑–∫–∏

```
1. –ü—Ä–æ–≤–µ—Ä–∫–∞ WebGL          ‚Üê –ú–æ–∂–µ—Ç —É–ø–∞—Å—Ç—å –µ—Å–ª–∏ –Ω–µ—Ç GPU/–¥—Ä–∞–π–≤–µ—Ä–æ–≤
2. –ó–∞–≥—Ä—É–∑–∫–∞ Three.js       ‚Üê CDN
3. –ó–∞–≥—Ä—É–∑–∫–∞ MindAR         ‚Üê CDN (1.7 MB)
4. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è TF.js     ‚Üê –í—ã–±–æ—Ä backend
5. –ó–∞–≥—Ä—É–∑–∫–∞ .mind –º–∞—Ä–∫–µ—Ä–∞  ‚Üê Fetch —Å —Å–µ—Ä–≤–µ—Ä–∞
6. –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–º–µ—Ä—ã         ‚Üê getUserMedia
7. _startVideo             ‚Üê –ó–∞–ø—É—Å–∫ –≤–∏–¥–µ–æ–ø–æ—Ç–æ–∫–∞ (~1 —Å–µ–∫)
8. _startAR                ‚Üê –ö–æ–º–ø–∏–ª—è—Ü–∏—è —à–µ–π–¥–µ—Ä–æ–≤ (10 —Å–µ–∫ - 3 –º–∏–Ω!)
9. Render loop             ‚Üê AR —Ä–∞–±–æ—Ç–∞–µ—Ç
```

---

## –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–∂–∏–º

–î–æ–±–∞–≤—å—Ç–µ `?diagnose=1` –∫ URL:
```
https://ar.neuroimagen.ru/view/xxx?diagnose=1
```

### –ß—Ç–µ–Ω–∏–µ –ª–æ–≥–æ–≤

```
02:08:25 LOG: WebGL info: {"ok":true,"renderer":"NVIDIA GeForce GTX 1060"}
02:08:26 LOG: TensorFlow.js backend: webgl     ‚Üê –î–æ–ª–∂–µ–Ω –±—ã—Ç—å webgl
02:08:26 LOG: MindARThree created successfully
02:08:26 LOG: Camera access granted            ‚Üê –ö–∞–º–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç
02:08:30 LOG: MindAR stage: _startVideo completed in 1121 ms
02:08:31 LOG: MindAR stage: _startAR started   ‚Üê –ó–¥–µ—Å—å –º–æ–∂–µ—Ç –∑–∞–≤–∏—Å–Ω—É—Ç—å
```

---

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ó–∞–≤–∏—Å–∞–Ω–∏–µ –Ω–∞ `_startAR` (–º–æ–±–∏–ª—å–Ω—ã–µ)

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–º–ø–∏–ª—è—Ü–∏—è WebGL —à–µ–π–¥–µ—Ä–æ–≤ TensorFlow.js –Ω–∞ –≥–ª–∞–≤–Ω–æ–º –ø–æ—Ç–æ–∫–µ.

**–ü—Ä–æ–±–ª–µ–º–Ω—ã–µ GPU:**
- Mali-G57, Mali-G52, Mali-G76
- –ù–µ–∫–æ—Ç–æ—Ä—ã–µ Adreno —Å–µ—Ä–∏–∏
- PowerVR –Ω–∞ —Å—Ç–∞—Ä—ã—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö

**–†–µ—à–µ–Ω–∏–µ:** –û—Ç–∫—Ä—ã—Ç—å –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä–µ –∏–ª–∏ –ø–æ–¥–æ–∂–¥–∞—Ç—å –¥–æ 3-5 –º–∏–Ω—É—Ç.

### 2. "WebGL is not supported" –ø—Ä–∏ —Ä–∞–±–æ—á–µ–º WebGL

**–ü—Ä–∏—á–∏–Ω–∞:** TensorFlow.js —Ç—Ä–µ–±—É–µ—Ç —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω—ã–µ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è (OES_texture_float).

**–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞:**
```
WebGL info: {ok: true}              ‚Üê –ë–∞–∑–æ–≤—ã–π WebGL —Ä–∞–±–æ—Ç–∞–µ—Ç
TensorFlow.js backend: cpu          ‚Üê TF.js —É–ø–∞–ª –Ω–∞ CPU
```

**–†–µ—à–µ–Ω–∏–µ:** –û–±–Ω–æ–≤–∏—Ç—å –¥—Ä–∞–π–≤–µ—Ä—ã GPU, –ø–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å Firefox.

### 3. –û—à–∏–±–∫–∞ `{}` (–ø—É—Å—Ç–æ–π –æ–±—ä–µ–∫—Ç)

**–ü—Ä–∏—á–∏–Ω–∞:** MindAR v1.1.5 –≤—ã–∑—ã–≤–∞–µ—Ç `reject()` –±–µ–∑ —Å–æ–æ–±—â–µ–Ω–∏—è.

**–ì–¥–µ —Å–º–æ—Ç—Ä–µ—Ç—å:** –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω—É—é –æ—à–∏–±–∫—É.

---

## –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞–º

| –£—Å—Ç—Ä–æ–π—Å—Ç–≤–æ | –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å | –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ |
|------------|------------|------------|
| –ö–æ–º–ø—å—é—Ç–µ—Ä + –≤–µ–±-–∫–∞–º–µ—Ä–∞ | ‚≠ê‚≠ê‚≠ê | –õ—É—á—à–∏–π –≤–∞—Ä–∏–∞–Ω—Ç |
| iPhone (Safari) | ‚≠ê‚≠ê‚≠ê | –†–∞–±–æ—Ç–∞–µ—Ç —Ö–æ—Ä–æ—à–æ |
| iPhone (Chrome) | ‚≠ê‚≠ê | Safari –ª—É—á—à–µ |
| Android (Chrome) | ‚≠ê‚≠ê | –ó–∞–≤–∏—Å–∏—Ç –æ—Ç GPU |
| Android (Samsung Internet) | ‚≠ê‚≠ê | –ò–Ω–æ–≥–¥–∞ –ª—É—á—à–µ Chrome |

---

## CDN –±–∏–±–ª–∏–æ—Ç–µ–∫–∏

```javascript
// Three.js ‚Äî —Å–æ–≤–º–µ—Å—Ç–∏–º —Å MindAR 1.1.5
'https://cdn.jsdelivr.net/npm/three@0.147.0/build/three.min.js'

// MindAR ‚Äî IIFE –±–∞–Ω–¥–ª (—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç window.MINDAR)
'https://cdn.jsdelivr.net/npm/mind-ar@1.1.5/dist/mindar-image-three.prod.js'
```

**–ü–æ—á–µ–º—É –Ω–µ v1.2.5?** ‚Äî –ò—Å–ø–æ–ª—å–∑—É–µ—Ç ES –º–æ–¥—É–ª–∏, –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ `<script>`.

---

## –õ–æ–∫–∞–ª—å–Ω—ã–µ –±–∏–±–ª–∏–æ—Ç–µ–∫–∏ (fallback)

–§–∞–π–ª—ã –≤ `static/js/`:
- `three.min.js`
- `mindar-image.prod.js`
- `mindar-image-three.prod.js`

–î–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –ª–æ–∫–∞–ª—å–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–∏—Ç–µ URLs –≤ `ar_content.py`.

---

## –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤—ã MindAR

| –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ | TensorFlow | –§–æ—Ä–º–∞—Ç –º–∞—Ä–∫–µ—Ä–æ–≤ | –°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å |
|------------|------------|-----------------|---------------|
| MindAR | –î–∞ (WebGL) | .mind | –°—Ä–µ–¥–Ω—è—è |
| AR.js NFT | –ù–µ—Ç | .fset/.fset3 | –í—ã—Å–æ–∫–∞—è |
| 8th Wall | –ù–µ—Ç | –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ | –í—ã—Å–æ–∫–∞—è (–ø–ª–∞—Ç–Ω–æ) |

---

## –§–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `app/api/routes/ar_content.py` | –ì–µ–Ω–µ—Ä–∞—Ü–∏—è HTML AR viewer |
| `static/js/*.js` | –õ–æ–∫–∞–ª—å–Ω—ã–µ –∫–æ–ø–∏–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫ |
| `scripts/legacy/build_mindar_cpu.py` | –£—Å—Ç–∞—Ä–µ–≤—à–∏–π —Å–∫—Ä–∏–ø—Ç CPU –ø–∞—Ç—á–∞ |
| `scripts/legacy/download_ar_viewer_libs.py` | –°–∫–∞—á–∏–≤–∞–Ω–∏–µ –±–∏–±–ª–∏–æ—Ç–µ–∫ |

---

## –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

### 2026-02-02
- ‚ùå –£–±—Ä–∞–Ω CPU backend fallback (–Ω–µ —Å–æ–≤–º–µ—Å—Ç–∏–º —Å MindAR)
- ‚úÖ –ü–µ—Ä–µ—Ö–æ–¥ –Ω–∞ CDN: Three.js 0.147.0 + MindAR 1.1.5
- ‚úÖ –†–∞–Ω–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ WebGL —Å –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π
- ‚úÖ Pre-check –∫–∞–º–µ—Ä—ã –¥–æ MindAR.start()
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —ç—Ç–∞–ø–æ–≤ `_startVideo`, `_startAR`
- ‚úÖ –¢–∞–π–º–∞—É—Ç 3 –º–∏–Ω –Ω–∞ –º–æ–±–∏–ª—å–Ω—ã—Ö (–±—ã–ª–æ 2)
- ‚úÖ AR —Ä–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –¥–µ—Å–∫—Ç–æ–ø–µ –∏ –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚úÖ –£–ª—É—á—à–µ–Ω—ã —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö
- üóëÔ∏è –£–¥–∞–ª—ë–Ω `docs/MINDAR_CPU_PATCH.md`
- üìÅ –ü–µ—Ä–µ–º–µ—â–µ–Ω—ã –≤ legacy: `build_mindar_cpu.py`, `download_ar_viewer_libs.py`
