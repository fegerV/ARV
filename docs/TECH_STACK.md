# Технологический стек

Подробное описание технологий, используемых в платформе ARV.

## Обзор

ARV - это B2B SaaS платформа для создания AR-контента, построенная на современном технологическом стеке с акцентом на производительность, масштабируемость и простоту разработки.

## Backend

### Python 3.11+

**Версия**: Python 3.11 или выше

**Почему**: 
- Высокая производительность
- Отличная поддержка асинхронности
- Богатая экосистема библиотек

**Использование**: Основной язык разработки backend

### FastAPI 0.109.0

**Описание**: Современный веб-фреймворк для создания API и HTML-рендеринга

**Особенности**:
- Автоматическая генерация документации (OpenAPI/Swagger)
- Встроенная валидация данных через Pydantic
- Высокая производительность (сопоставима с Node.js и Go)
- Поддержка асинхронных операций
- Type hints из коробки

**Использование**:
- REST API endpoints
- HTML-рендеринг через Jinja2
- WebSocket (планируется)

### SQLAlchemy 2.0.41

**Описание**: Мощный ORM для работы с базами данных

**Особенности**:
- Асинхронная поддержка (async/await)
- Type hints
- Гибкая система запросов
- Поддержка миграций через Alembic

**Использование**:
- Модели данных
- Запросы к базе данных
- Транзакции

### Alembic 1.13.1

**Описание**: Инструмент миграций для SQLAlchemy

**Особенности**:
- Автоматическое обнаружение изменений в моделях
- Версионирование схемы БД
- Откат миграций

**Использование**:
- Управление схемой базы данных
- Миграции при развертывании

### Pydantic 2.10.4

**Описание**: Библиотека для валидации данных и настроек

**Особенности**:
- Валидация на основе type hints
- Сериализация/десериализация
- Настройки из переменных окружения

**Использование**:
- Валидация входных данных API
- Схемы запросов/ответов
- Конфигурация приложения

### Uvicorn 0.27.0

**Описание**: ASGI сервер для запуска FastAPI

**Особенности**:
- Высокая производительность
- Поддержка HTTP/2
- Hot reload для разработки

**Использование**:
- Запуск приложения в разработке и продакшене

## База данных

### SQLite (разработка)

**Версия**: Встроенная в Python

**Использование**:
- Локальная разработка
- Тестирование
- Быстрый старт проекта

**Ограничения**:
- Не подходит для продакшена с высокой нагрузкой
- Ограниченная поддержка конкурентных записей

### PostgreSQL 15 (продакшен)

**Описание**: Мощная реляционная СУБД

**Особенности**:
- Высокая производительность
- Надежность и ACID-совместимость
- Богатый набор функций
- Масштабируемость

**Использование**:
- Продакшен окружение
- Высоконагруженные системы

**Драйвер**: `asyncpg 0.31.0` - асинхронный драйвер PostgreSQL

## Frontend

### Jinja2 3.1.3

**Описание**: Шаблонизатор для Python

**Особенности**:
- Серверный рендеринг
- Наследование шаблонов
- Макросы и фильтры
- Интеграция с FastAPI

**Использование**:
- HTML шаблоны
- Динамическая генерация страниц

### htmx

**Описание**: Библиотека для динамических обновлений без JavaScript

**Особенности**:
- AJAX через HTML-атрибуты
- Минимальный JavaScript
- Серверный рендеринг
- Поддержка WebSocket (планируется)

**Использование**:
- Динамические обновления страниц
- Формы без перезагрузки
- Пагинация

**Версия**: Загружается через CDN

### Alpine.js

**Описание**: Легковесный фреймворк для реактивности

**Особенности**:
- Минимальный размер (~15KB)
- Реактивность из коробки
- Простой синтаксис
- Работает без сборки

**Использование**:
- Локальное состояние компонентов
- Интерактивные элементы UI
- Модальные окна
- Dropdown меню

**Версия**: Загружается через CDN

### Tailwind CSS 4.1.18

**Описание**: Utility-first CSS фреймворк

**Особенности**:
- Быстрая разработка UI
- Минимальный размер (с tree-shaking)
- Кастомизация через конфигурацию
- Responsive дизайн из коробки

**Использование**:
- Стилизация всех компонентов
- Адаптивный дизайн
- Темная тема (планируется)

### Material Icons

**Описание**: Иконки от Google

**Использование**:
- Иконки в интерфейсе
- Загружается через CDN

## AR/VR

### MindAR 1.2.5

**Описание**: JavaScript библиотека для AR на основе распознавания изображений

**Особенности**:
- Работает в браузере (WebAR)
- Не требует установки приложений
- Поддержка NFT (Natural Feature Tracking) маркеров
- Интеграция с Three.js

**Использование**:
- Распознавание изображений в AR viewer
- Генерация маркеров (.mind файлы)
- Отображение AR-контента

**Node.js зависимости**:
- `mind-ar`: Основная библиотека
- `canvas`: Для серверной генерации маркеров

### Three.js (планируется)

**Описание**: 3D библиотека для WebGL

**Планируемое использование**:
- 3D модели в AR
- Расширенная визуализация
- Интерактивные 3D объекты

## Обработка медиа

### Pillow 11.0.0

**Описание**: Библиотека для обработки изображений

**Использование**:
- Ресайз изображений
- Генерация превью
- Конвертация форматов
- Валидация изображений

### OpenCV 4.9.0.80

**Описание**: Библиотека компьютерного зрения

**Использование**:
- Анализ качества изображений
- Обработка видео
- Генерация превью видео

### FFmpeg (через ffmpeg-python)

**Описание**: Инструмент для обработки видео

**Использование**:
- Конвертация видео
- Генерация превью
- Извлечение кадров

### QRCode 7.4.2

**Описание**: Генерация QR-кодов

**Использование**:
- QR-коды для AR-контента
- Ссылки на AR viewer

## Безопасность

### python-jose 3.3.0

**Описание**: Библиотека для работы с JWT

**Использование**:
- Создание и валидация JWT токенов
- Аутентификация пользователей

### passlib 1.7.4

**Описание**: Библиотека для хеширования паролей

**Использование**:
- Хеширование паролей (SHA-256)
- Проверка паролей

### bcrypt 4.3.0

**Описание**: Алгоритм хеширования паролей

**Примечание**: В проекте используется SHA-256, но bcrypt доступен для будущего использования

## Логирование и мониторинг

### structlog 24.1.0

**Описание**: Структурированное логирование

**Особенности**:
- Структурированные логи (JSON)
- Контекстное логирование
- Интеграция с различными форматерами

**Использование**:
- Логирование всех операций
- Отладка
- Мониторинг

### prometheus-client 0.19.0

**Описание**: Клиент для Prometheus

**Использование**:
- Метрики производительности
- Мониторинг приложения
- Интеграция с Grafana (планируется)

## Инфраструктура

### Docker & Docker Compose

**Описание**: Контейнеризация приложения

**Использование**:
- Развертывание
- Изоляция окружений
- Упрощение разработки

### Redis (планируется)

**Описание**: In-memory хранилище данных

**Планируемое использование**:
- Кэширование
- Сессии
- Очереди задач
- Pub/Sub для уведомлений

### Nginx (планируется)

**Описание**: Веб-сервер и reverse proxy

**Планируемое использование**:
- Reverse proxy для FastAPI
- Раздача статических файлов
- SSL/TLS терминация
- Load balancing

## Утилиты разработки

### pytest 7.4.4

**Описание**: Фреймворк для тестирования

**Использование**:
- Юнит-тесты
- Интеграционные тесты
- Тестирование API

### pytest-asyncio 0.23.3

**Описание**: Поддержка async/await в pytest

**Использование**:
- Тестирование асинхронного кода

### pytest-cov 4.1.0

**Описание**: Покрытие кода тестами

**Использование**:
- Измерение покрытия кода
- Отчеты о покрытии

### black 23.12.1

**Описание**: Форматтер кода Python

**Использование**:
- Автоматическое форматирование кода
- Единый стиль кода

### isort 5.13.2

**Описание**: Сортировка импортов

**Использование**:
- Автоматическая сортировка импортов
- Организация импортов

### flake8 7.0.0

**Описание**: Линтер для Python

**Использование**:
- Проверка стиля кода
- Обнаружение ошибок

### mypy 1.8.0

**Описание**: Статический анализатор типов

**Использование**:
- Проверка типов
- Обнаружение ошибок типизации

## Зависимости Node.js

### mind-ar 1.2.5

**Описание**: Библиотека для генерации AR-маркеров

**Использование**:
- Генерация .mind файлов
- Компиляция маркеров

### canvas 3.2.0

**Описание**: Серверная реализация Canvas API

**Использование**:
- Обработка изображений в Node.js
- Генерация маркеров

## Архитектурные решения

### Серверный рендеринг (SSR)

**Почему**: 
- Быстрая загрузка страниц
- SEO-friendly
- Меньше JavaScript на клиенте

**Реализация**: FastAPI + Jinja2

### Минимальный JavaScript

**Почему**:
- Быстрая загрузка
- Простота поддержки
- Меньше зависимостей

**Реализация**: htmx + Alpine.js

### Асинхронность

**Почему**:
- Высокая производительность
- Масштабируемость
- Эффективное использование ресурсов

**Реализация**: async/await, SQLAlchemy async, asyncpg

### Type Hints

**Почему**:
- Лучшая читаемость кода
- Обнаружение ошибок на этапе разработки
- Автодополнение в IDE

**Реализация**: Везде в коде Python

## Версии и совместимость

Все версии зависимостей зафиксированы в:
- `requirements.txt` - Python зависимости
- `package.json` - Node.js зависимости

Рекомендуется использовать точные версии для воспроизводимости окружений.

## Обновление зависимостей

### Python

```bash
pip install --upgrade -r requirements.txt
```

### Node.js

```bash
npm update
```

⚠️ **Важно**: После обновления протестируйте приложение на совместимость.

## Дополнительные ресурсы

- [FastAPI Documentation](https://fastapi.tiangolo.com/)
- [SQLAlchemy Documentation](https://docs.sqlalchemy.org/)
- [Alembic Documentation](https://alembic.sqlalchemy.org/)
- [MindAR Documentation](https://github.com/hiukim/mind-ar-js)
- [htmx Documentation](https://htmx.org/)
- [Alpine.js Documentation](https://alpinejs.dev/)
- [Tailwind CSS Documentation](https://tailwindcss.com/)
