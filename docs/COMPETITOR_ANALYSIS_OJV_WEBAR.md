# Анализ конкурента: OJV! / "Оживи" (AR Production)

## Общая информация

- **Компания**: AR Production (ТОО "АРкорп", Казахстан / ИП Астров А.В., Москва)
- **Бренд**: "Оживи" / OJV!
- **Сайт**: [ojv.biz](https://ojv.biz/)
- **WebAR**: `https://webar.ojv.biz/?code={id}`
- **Админ-панель**: `https://admin.ojv.biz/web/login`
- **Android**: [Google Play](https://play.google.com/store/apps/details?id=ru.arproduction.mmrs) — 1M+ скачиваний, 4.2 рейтинг, 6.9K отзывов
- **iOS**: Есть (упоминается на сайте)
- **Компания существует с**: 2011 года (AR/VR проекты), сервис "Оживи" — с февраля 2019
- **Пользователей**: 1 200 000+ из разных стран (США, Великобритания, Перу)
- **Email поддержки**: support@mmrs.me, hello@ojv.biz
- **Телефон**: +7 (495) 627-61-68

---

## 0. Бизнес-модель и позиционирование

### 0.1 Целевая аудитория

- **Фотографы** — оживающие фотоальбомы (школьные, свадебные, юбилейные)
- **Типографии и полиграфия** — живые визитки, буклеты, брендбуки
- **Производители сувениров** — кружки, футболки, брелоки с AR
- **Рекламные агентства** — наружная реклама с AR
- **Книжные издательства** — оживающие иллюстрации
- **Рестораны** — AR-меню
- **Музеи и выставки** — оживающие экспонаты

### 0.2 Тарифы

| Тариф | Цена | Включено |
|-------|------|----------|
| **Бесплатный** | 0 (7 дней) | 5 оживлений в подарок |
| **Бронзовый** | 1 500 000 тенге (~$3 200) | Онлайн-редактор, поддержка, 1 рабочее место, пуш-уведомления |
| **Серебряный** | 2 500 000 тенге (~$5 300) | Всё из бронзового + 3 рабочих места, 3D-модели, эффекты, визитки, календари |

### 0.3 Ключевые обещания

- **Хранение контента 30 лет бесплатно** (Amazon AWS + Yandex.Cloud)
- Создание AR за 30 секунд
- Работает **без установки приложения** (WebAR через QR-код)
- Увеличение среднего чека на 80-200% (по отзывам пользователей)
- Более 150 реализованных проектов для крупных брендов
- Гарантия возврата денег в течение 2 месяцев

### 0.4 Двойная платформа доставки

| Способ | Описание |
|--------|----------|
| **WebAR** (основной) | Сканирование QR-кода камерой → браузер → AR без установки |
| **Приложение OJV!** | Для старых устройств (iOS < 14, Android < 6) и расширенного функционала |

---

## 1. Архитектура приложения

### 1.1 Frontend фреймворк

- **Vue.js 3** (runtime) — SPA-приложение на Vue 3 с Composition API
- **Vue I18n v11.2.2** — поддержка мультиязычности (i18n)
- **Vue Router** — клиентская маршрутизация
- **Vite** — сборщик (Vite build, asset hashing `*-DiIns1YN.js`, `*-DM_sAveM.js`)

### 1.2 Структура бандла

| Файл | Размер | Содержимое |
|------|--------|------------|
| `index-DM_sAveM.js` | ~330 KB | Основное приложение: Vue 3, Vue I18n, GSAP, AR-логика, Three.js рендерер |
| `three-BjMB8w6M.js` | ~715 KB | Three.js (полная версия WebGL-рендерера, включая WebXR) |
| `tracker-DiIns1YN.js` | ~20 KB | Модуль трекинга маркеров (WorkerTracker, AsyncWorkerTracker) |
| `index-CBB8M6HC.css` | ? | Стили приложения |

**Итого JS: ~1065 KB** (минифицированный, без gzip)

### 1.3 Идентификация контента

- Контент загружается по параметру `?code=id0000176721`
- Формат кода: `id` + числовой идентификатор

---

## 2. Система трекинга маркеров (ключевое отличие)

### 2.1 Собственный Computer Vision пайплайн на WebAssembly

OJV использует **собственный C/C++ пайплайн компьютерного зрения**, скомпилированный в WebAssembly:

```
/wasm_build/cv_pipeline.wasm   — основной WASM-модуль
/wasm_build/cv_pipeline.js     — JS-обёртка (Emscripten)
```

Это **НЕ MindAR**, **НЕ AR.js**, **НЕ JSARToolKit** — это полностью кастомное решение.

### 2.2 Детекторы feature-точек

Поддерживаются **два детектора** (переключаемые на лету):

| Детектор | Описание | Использование |
|----------|----------|---------------|
| **AKAZE** | Ускоренные нелинейные дескрипторы (более точный, тяжелее) | По умолчанию для мощных устройств |
| **ORB** | Oriented FAST + Rotated BRIEF (быстрее, менее точный) | Для слабых устройств, фоллбэк |

### 2.3 Оптический поток (KLT Tracker)

После первичного обнаружения маркера используется **KLT (Kanade-Lucas-Tomasi) optical flow** для отслеживания между кадрами:

- `klt_enabled: true` — активирован по умолчанию
- `klt_win_size: 25` — размер окна поиска
- `klt_max_level: 3-5` — уровни пирамиды
- `klt_min_tracked_points: 20-40` — минимум точек для трекинга
- `klt_bidirectional_check` — двунаправленная проверка (для мощных устройств)
- `klt_force_redetect_frames: 600-1000` — принудительное переобнаружение каждые N кадров

### 2.4 ROI (Region of Interest) — оптимизация

- Адаптивный ROI: поиск маркера только в области интереса
- `roi.base: 2-3` — базовый множитель области
- `roi.autoAdjust: true` — автоматическая подстройка
- `roi.min/max` — границы масштабирования ROI

### 2.5 Kalman-фильтр

- Встроенный фильтр Калмана для сглаживания позиции маркера
- `setKalmanEnabled(true)` — активирован по умолчанию

### 2.6 Quality Gates

Система контроля качества трекинга:

```javascript
qualityConfig: {
    gateMaxReproj: 24,        // Макс. ошибка репроекции (пикселей)
    gateMinInlier: 0.22,      // Мин. доля инлайеров
    gateMinPoints: 20,        // Мин. количество точек
    kltMaxReproj: 14.4,       // Макс. ошибка KLT
    kltMinInlier: 0.1925,     // Мин. инлайеры KLT
    kltMaxJitter: 90,         // Макс. джиттер
    kltMaxAspect: 0.375       // Макс. искажение аспекта
}
```

---

## 3. Адаптивная система производительности

### 3.1 Определение класса устройства (DeviceDetector)

Автоматическая классификация устройств на 4 категории:

| Категория | Условия |
|-----------|---------|
| **potato** | Legacy-устройства (Android 5-7), старые чипсеты (MSM8916 и т.д.) |
| **low-end** | ≤2 ядра или ≤2 ГБ RAM, слабые ARM-чипсеты (Kirin 650, Snapdragon 425 и т.д.) |
| **mid-range** | 2-6 ядер, 4+ ГБ RAM |
| **high-end** | 8+ ядер, 8+ ГБ RAM |

### 3.2 База известных слабых чипсетов

Система содержит **обширные списки** конкретных слабых чипсетов:

- **Huawei Kirin**: 650, 655, 658, 659
- **Qualcomm Snapdragon**: 425-450, 625-632
- **MediaTek Helio**: P10-P23, A22, MT6737-MT6763
- **Samsung Exynos**: 7870-7904, 850, 9610-9611

### 3.3 Профили производительности

Каждая категория устройства имеет свой профиль:

| Параметр | potato | low-end | mid-range | high-end |
|----------|--------|---------|-----------|----------|
| Разрешение | 0.5x | 0.6x | 0.7x | 0.8x |
| Frame Skip | 2 (AKAZE) / 0 (ORB) | 1 / 0 | 0 | 0 |
| Детектор | ORB | ORB | ORB/AKAZE | ORB/AKAZE |
| nfeatures (ORB) | 1000 | 1500 | 2000 | 2500 |
| KLT levels | 3 | 3 | 3 | 3-5 |
| KLT points | 25 | 25 | 30 | 40 |

### 3.4 Динамическая адаптация (AdaptiveController)

В рантайме система **автоматически подстраивает** параметры:

- Мониторинг FPS, времени детекции, процента обнаружений
- **Downgrade**: если p95 > 1.3x от целевого FPS → увеличить frameSkip, переключить AKAZE→ORB
- **Upgrade**: если p95 < 0.7x от целевого FPS и foundRate > 80% → уменьшить frameSkip, попробовать AKAZE
- Целевой FPS: 30
- Интервал проверки: каждые 60 кадров
- CPU-бенчмарк для уточнения категории

---

## 4. Архитектура трекинга (Workers)

### 4.1 Web Worker для CV-пайплайна

Весь CV-пайплайн работает в отдельном **Web Worker**:

```
Main thread  →  WorkerBridge  →  Worker (tracker-worker-n20.js)
                                    ↓
                              WebAssembly (cv_pipeline.wasm)
```

- **WorkerBridge** — класс для коммуникации с Worker через `postMessage`
- Каждая команда имеет `messageId` и Promise-based ответ
- Поддержка передачи `ArrayBuffer` через Transferable Objects

### 4.2 SharedArrayBuffer (SAB) для нулевого копирования

На поддерживаемых устройствах используется **SharedArrayBuffer**:

```javascript
// SharedFrameBuffer: 2560x1440 максимум
this.sharedFrameBuffer = new SharedFrameBuffer(2560, 1440);
await this.bridge._sendCommand("setSharedBuffer", {
    sharedBuffer: this.sharedFrameBuffer.getSharedBuffer(),
    maxWidth: 2560,
    maxHeight: 1440
});
```

- Кадры записываются в shared memory без копирования
- Worker читает данные напрямую из shared buffer
- Фоллбэк на `ImageBitmap` transfer если SAB не поддерживается

### 4.3 FrameProcessor (VideoFrame API)

Оптимизированный извлечение пикселей:

- Приоритет: **VideoFrame API** → Canvas fallback
- `FrameProcessor.extractRGBA()` для извлечения RGBA-данных
- `OffscreenCanvas` с `willReadFrequently: true` как запасной вариант

### 4.4 AsyncWorkerTracker

Асинхронная обёртка для непрерывного трекинга:

- Очередь кадров (`maxQueueSize: 1`) — только последний кадр
- Автоматический сброс устаревших кадров
- `startContinuousDetection(videoElement, { intervalMs: 33 })` — ~30 FPS
- Callbacks: `onResult`, `onError`

---

## 5. 3D-рендеринг (Three.js)

### 5.1 Сцена и камера

```javascript
this.scene = new THREE.Scene();
this.camera = new THREE.PerspectiveCamera(fov=20, aspect, near=0.01, far=1000);
this.camera.matrixAutoUpdate = false;  // Матрица управляется трекером
```

### 5.2 WebGL рендерер

```javascript
this.renderer = new THREE.WebGLRenderer({
    canvas: canvas,
    alpha: true,      // Прозрачный фон (видео камеры просвечивает)
    antialias: true
});
```

### 5.3 Видео-оверлей

Видео накладывается на маркер как **плоская плоскость** (Quad):

```javascript
// BufferGeometry: простой квад из 4 вершин
// Material: MeshBasicMaterial с VideoTexture
// Масштабирование по размеру маркера
```

- **VideoTexture** из `<video>` элемента
- `flipY: false` — видео не инвертируется
- `MeshBasicMaterial` с `transparent: true`, `DoubleSide`
- Fit-режим: `contain` (вписать видео в маркер с сохранением пропорций)

### 5.4 Матричные преобразования

- View Matrix (16 float) приходит от трекера
- Model Matrix = View Matrix × Scale Matrix (по размеру маркера)
- Camera матрица управляется вручную (не autoUpdate)
- Проверка determinant > 1e-8 для валидности матрицы

### 5.5 Управление видео

- Автозапуск при видимом маркере
- Автопауза при потере маркера
- Freeze-режим (пауза без скрытия)
- Горячая замена видеоисточника

---

## 6. Анимации (GSAP)

- Используется **GSAP** (GreenSock Animation Platform) для UI-анимаций
- Timeline-based анимации для плавных переходов

---

## 7. Ключевые технические решения

### 7.1 Что делает их систему конкурентоспособной

| Решение | Преимущество |
|---------|-------------|
| **Собственный WASM CV-пайплайн** | Полный контроль, оптимизация под WebAR |
| **Два детектора (AKAZE + ORB)** | Баланс точности и скорости |
| **KLT optical flow** | Плавный трекинг между кадрами, экономия CPU |
| **Адаптивная система** | Работает на всех устройствах от potato до high-end |
| **SharedArrayBuffer** | Нулевое копирование данных → меньше задержек |
| **Web Worker** | Трекинг не блокирует UI thread |
| **ROI-оптимизация** | Обработка только области интереса → быстрее |
| **Kalman-фильтр** | Сглаживание джиттера 3D-объекта |
| **Quality gates** | Автоматическое скрытие при плохом трекинге |

### 7.2 Слабые стороны / ограничения

| Ограничение | Описание |
|-------------|----------|
| **Высокие тарифы** | $3 200–$5 300 за лицензию — доступно только для бизнеса |
| **Большой бандл** | ~1 MB JS + WASM → долгая первая загрузка на мобильном интернете |
| **Один маркер за раз** | `setActiveMarker` указывает на поддержку multi-marker, но основной flow — один |
| **Hardcoded video path** | `overlayVideo.src = "/video/video_1.mp4"` — привязка к серверному пути |
| **Нет WebXR** | Three.js содержит WebXR-модуль, но он не используется для основного AR |
| **Юрисдикция** | ТОО в Казахстане — возможные сложности для российских клиентов |
| **Зависимость от облаков** | Amazon AWS + Yandex.Cloud — риски блокировок, цены на хранение |
| **Приложение — фоллбэк** | Нативное приложение не основное, а fallback для старых устройств |

---

## 8. Сравнение с нашей системой (Vertex AR)

| Аспект | OJV! "Оживи" | Vertex AR |
|--------|-----------|-----------|
| **Платформа** | WebAR (основная) + нативное приложение (фоллбэк) | Android-приложение + WebAR |
| **Нативное приложение** | 1M+ скачиваний, 4.2 рейтинг | В разработке |
| **Трекинг** | Собственный WASM (AKAZE/ORB + KLT) | MindAR / ARCore |
| **Рендеринг** | Three.js (WebGL) | Three.js (WebGL) + GLSurfaceView (Android) |
| **Адаптивность** | 4 профиля устройств, авто-подстройка | Нет адаптивной системы |
| **Видео** | VideoTexture на плоскости | Видео-оверлей |
| **Backend** | SPA + API (неизвестный стек), AWS + Yandex.Cloud | FastAPI + SQLite, self-hosted |
| **Контент** | По коду (`?code=id...`) | По UUID (`/view/{uuid}`) |
| **Мультиязычность** | Vue I18n (ru/en) | Нет |
| **Worker threading** | Да (Web Worker + SAB) | Нет |
| **Бизнес-модель** | B2B SaaS, лицензии $3K-$5K | B2B SaaS (в разработке) |
| **Пользователи** | 1 200 000+ | Начальная стадия |
| **Хранение контента** | 30 лет, облако | Self-hosted |
| **Онлайн-конструктор** | Да (редактор видео, визитки, календари, эффекты) | Админ-панель |
| **Инструменты создателя** | Обучающий бот, интенсив, чат поддержки | Документация |

---

## 9. Рекомендации для Vertex AR

### 9.1 Технические улучшения (на основе анализа конкурента)

1. **Адаптивная система производительности** — определение класса устройства и подстройка параметров трекинга/рендеринга
2. **Web Worker для трекинга** — вынести тяжёлые вычисления из основного потока (для WebAR)
3. **KLT optical flow** — для сглаживания трекинга между кадрами детекции
4. **Quality gates** — автоматическое скрытие 3D-контента при потере качества трекинга
5. **SharedArrayBuffer** — для WebAR: нулевое копирование кадров в Worker
6. **Kalman-фильтр** — для сглаживания джиттера виртуальных объектов

### 9.2 Бизнес-возможности (чему можно научиться)

1. **WebAR без установки** — OJV делает ставку на то, что AR работает без приложения по QR-коду. Это снижает порог входа для конечного пользователя
2. **Онлайн-конструктор для создателей** — встроенный видеоредактор, шаблоны визиток, календарей, эффектов → клиент делает всё сам
3. **Обучающий бот / интенсив** — снижает нагрузку на поддержку, повышает конверсию
4. **Гарантия хранения 30 лет** — сильный маркетинговый аргумент для фотографов
5. **B2B фокус на фотографов и полиграфию** — чёткая ниша с понятным value proposition
6. **Бесплатный trial (7 дней, 5 оживлений)** — позволяет попробовать перед покупкой
7. **Мультиязычность (ru/en)** — расширяет рынок

### 9.3 Конкурентные преимущества Vertex AR (что у нас лучше)

1. **Нативное Android-приложение как основная платформа** — более стабильный AR через ARCore
2. **Self-hosted** — полный контроль, нет зависимости от облачных провайдеров
3. **Более низкий порог входа по цене** (потенциально) — если предложить более доступные тарифы
4. **FastAPI + SQLite** — простой, лёгкий backend без сложной инфраструктуры

---

## 10. Резюме

OJV!/Оживи — зрелый продукт (с 2019 года) с 1.2M+ пользователей и серьёзной технической базой. Их главная ставка — **WebAR без установки приложения** с собственным WASM CV-пайплайном. Бизнес-модель ориентирована на B2B (фотографы, типографии, сувенирщики) с высокими тарифами ($3K-$5K за лицензию).

Для Vertex AR основные точки роста:
- **Техническая**: адаптивная система производительности, Web Workers, качество трекинга
- **Продуктовая**: онлайн-конструктор для создателей, бесплатный trial, обучение
- **Рыночная**: более доступные тарифы, фокус на российский рынок (self-hosted, без зависимости от зарубежных облаков)

---

*Анализ проведён 10.02.2026 на основе деобфускации продакшн-бандла `webar.ojv.biz`, данных Google Play и сайта ojv.biz*
